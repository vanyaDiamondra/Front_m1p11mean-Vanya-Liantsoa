{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/common\";\nfunction NotificationListComponent_div_4_ul_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ul\", 9)(1, \"li\")(2, \"a\", 10);\n    i0.ɵɵlistener(\"click\", function NotificationListComponent_div_4_ul_5_Template_a_click_2_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r4);\n      const notification_r2 = restoredCtx.$implicit;\n      const ctx_r3 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r3.navigateToPost(notification_r2._id));\n    });\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelement(4, \"hr\", 11);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const notification_r2 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", notification_r2.nom, \" \");\n  }\n}\nfunction NotificationListComponent_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 4)(1, \"div\", 5)(2, \"h5\", 6);\n    i0.ɵɵtext(3, \"Notifications\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 7);\n    i0.ɵɵtemplate(5, NotificationListComponent_div_4_ul_5_Template, 5, 1, \"ul\", 8);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.notifications.reverse());\n  }\n}\nexport class NotificationListComponent {\n  constructor(http, router, ngZone) {\n    this.http = http;\n    this.router = router;\n    this.ngZone = ngZone;\n    this.notifications = [];\n    this.clickNotif = false;\n  }\n  ngOnInit() {\n    this.eventSource = new EventSource('http://localhost:3000/notifications/stream');\n    this.eventSource.onmessage = event => {\n      const notification = JSON.parse(event.data);\n      this.ngZone.run(() => {\n        this.notifications.push(notification);\n        console.log(this.notifications);\n      });\n    };\n  }\n  ngOnDestroy() {\n    if (this.eventSource) {\n      this.eventSource.close();\n    }\n  }\n  toggleNotif() {\n    this.clickNotif = !this.clickNotif;\n  }\n  navigateToPost(offreId) {\n    this.router.navigate(['/offres', offreId]);\n  }\n  static #_ = this.ɵfac = function NotificationListComponent_Factory(t) {\n    return new (t || NotificationListComponent)(i0.ɵɵdirectiveInject(i1.HttpClient), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i0.NgZone));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: NotificationListComponent,\n    selectors: [[\"app-notification-list\"]],\n    decls: 5,\n    vars: 2,\n    consts: [[1, \"icon-btn\", \"sideMenuToggler2\", 3, \"click\"], [1, \"fa-light\", \"fa-bell\"], [1, \"badge\"], [\"class\", \"col-md-12 col-lg-12 col-xl-12\", \"class\", \"sub-menu\", 4, \"ngIf\"], [1, \"sub-menu\"], [1, \"widget\", \"woocommerce\", \"widget_shopping_cart\", 2, \"width\", \"300px\", \"position\", \"relative\", \"right\", \"200px\", \"background-color\", \"white\"], [1, \"widget_title\"], [1, \"widget_shopping_cart_content\"], [\"class\", \"woocommerce-mini-cart cart_list product_list_widget\", 4, \"ngFor\", \"ngForOf\"], [1, \"woocommerce-mini-cart\", \"cart_list\", \"product_list_widget\"], [2, \"font-size\", \"15px\", 3, \"click\"], [1, \"style1\"]],\n    template: function NotificationListComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"a\", 0);\n        i0.ɵɵlistener(\"click\", function NotificationListComponent_Template_a_click_0_listener() {\n          return ctx.toggleNotif();\n        });\n        i0.ɵɵelement(1, \"i\", 1);\n        i0.ɵɵelementStart(2, \"span\", 2);\n        i0.ɵɵtext(3);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(4, NotificationListComponent_div_4_Template, 6, 1, \"div\", 3);\n        i0.ɵɵelementEnd();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(ctx.notifications.length);\n        i0.ɵɵadvance();\n        i0.ɵɵproperty(\"ngIf\", ctx.clickNotif);\n      }\n    },\n    dependencies: [i3.NgForOf, i3.NgIf],\n    styles: [\"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n  });\n}","map":{"version":3,"names":["i0","ɵɵelementStart","ɵɵlistener","NotificationListComponent_div_4_ul_5_Template_a_click_2_listener","restoredCtx","ɵɵrestoreView","_r4","notification_r2","$implicit","ctx_r3","ɵɵnextContext","ɵɵresetView","navigateToPost","_id","ɵɵtext","ɵɵelementEnd","ɵɵelement","ɵɵadvance","ɵɵtextInterpolate1","nom","ɵɵtemplate","NotificationListComponent_div_4_ul_5_Template","ɵɵproperty","ctx_r0","notifications","reverse","NotificationListComponent","constructor","http","router","ngZone","clickNotif","ngOnInit","eventSource","EventSource","onmessage","event","notification","JSON","parse","data","run","push","console","log","ngOnDestroy","close","toggleNotif","offreId","navigate","_","ɵɵdirectiveInject","i1","HttpClient","i2","Router","NgZone","_2","selectors","decls","vars","consts","template","NotificationListComponent_Template","rf","ctx","NotificationListComponent_Template_a_click_0_listener","NotificationListComponent_div_4_Template","ɵɵtextInterpolate","length"],"sources":["D:\\documents\\M1\\Web Avancée\\mean_beautysalon\\Front_m1p11mean-Vanya-Liantsoa\\src\\app\\components\\notification\\notification-list.component.ts","D:\\documents\\M1\\Web Avancée\\mean_beautysalon\\Front_m1p11mean-Vanya-Liantsoa\\src\\app\\components\\notification\\notification-list.component.html"],"sourcesContent":["import { Component, OnInit, OnDestroy, NgZone } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Router } from '@angular/router';\r\n\r\n@Component({\r\n  selector: 'app-notification-list',\r\n  templateUrl: './notification-list.component.html',\r\n  styleUrls: ['./notification-list.component.css']\r\n})\r\nexport class NotificationListComponent implements OnInit, OnDestroy {\r\n  notifications: any[] = [];\r\n  eventSource: EventSource | undefined;\r\n  clickNotif = false;\r\n\r\n  constructor(private http: HttpClient, private router: Router,private ngZone: NgZone) { }\r\n\r\n  ngOnInit(): void {\r\n    this.eventSource = new EventSource('http://localhost:3000/notifications/stream');\r\n    this.eventSource.onmessage = event => {\r\n      const notification = JSON.parse(event.data);\r\n      this.ngZone.run(() => {\r\n        this.notifications.push(notification);\r\n        console.log(this.notifications);\r\n      });\r\n    };\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.eventSource) {\r\n      this.eventSource.close();\r\n    }\r\n  }\r\n  toggleNotif() {\r\n    this.clickNotif = !this.clickNotif;\r\n  }\r\n\r\n  navigateToPost(offreId: string): void {\r\n    this.router.navigate(['/offres', offreId]);\r\n  }\r\n}\r\n","<a (click)=\"toggleNotif()\" class=\"menu-item-has-children\" class=\"icon-btn sideMenuToggler2\">\r\n<i class=\"fa-light fa-bell\"></i> <span class=\"badge\" >{{notifications.length}}</span>\r\n<div class=\"col-md-12 col-lg-12 col-xl-12\" class=\"sub-menu\" *ngIf=\"clickNotif\">\r\n    <div class=\"widget woocommerce widget_shopping_cart\" style=\"width: 300px; position: relative; right: 200px; background-color: white;\">\r\n        <h5 class=\"widget_title\">Notifications</h5>\r\n<div class=\"widget_shopping_cart_content\">\r\n  <ul class=\"woocommerce-mini-cart cart_list product_list_widget\"  *ngFor=\"let notification of notifications.reverse()\">\r\n      <li>\r\n        <a (click)=\"navigateToPost(notification._id)\" style=\"font-size: 15px;\">  {{ notification.nom }} </a>\r\n      </li><hr class=\"style1\">\r\n  </ul>\r\n</div>\r\n</div>\r\n</div>\r\n</a>\r\n\r\n\r\n\r\n\r\n"],"mappings":";;;;;;;ICMEA,EAAA,CAAAC,cAAA,YAAsH;IAE7GD,EAAA,CAAAE,UAAA,mBAAAC,iEAAA;MAAA,MAAAC,WAAA,GAAAJ,EAAA,CAAAK,aAAA,CAAAC,GAAA;MAAA,MAAAC,eAAA,GAAAH,WAAA,CAAAI,SAAA;MAAA,MAAAC,MAAA,GAAAT,EAAA,CAAAU,aAAA;MAAA,OAASV,EAAA,CAAAW,WAAA,CAAAF,MAAA,CAAAG,cAAA,CAAAL,eAAA,CAAAM,GAAA,CAAgC;IAAA,EAAC;IAA4Bb,EAAA,CAAAc,MAAA,GAAuB;IAAAd,EAAA,CAAAe,YAAA,EAAI;IACjGf,EAAA,CAAAgB,SAAA,aAAmB;IAC5BhB,EAAA,CAAAe,YAAA,EAAK;;;;IAF0Ef,EAAA,CAAAiB,SAAA,GAAuB;IAAvBjB,EAAA,CAAAkB,kBAAA,MAAAX,eAAA,CAAAY,GAAA,MAAuB;;;;;IANxGnB,EAAA,CAAAC,cAAA,aAA+E;IAE9CD,EAAA,CAAAc,MAAA,oBAAa;IAAAd,EAAA,CAAAe,YAAA,EAAK;IACnDf,EAAA,CAAAC,cAAA,aAA0C;IACxCD,EAAA,CAAAoB,UAAA,IAAAC,6CAAA,gBAIK;IACPrB,EAAA,CAAAe,YAAA,EAAM;;;;IALsFf,EAAA,CAAAiB,SAAA,GAA0B;IAA1BjB,EAAA,CAAAsB,UAAA,YAAAC,MAAA,CAAAC,aAAA,CAAAC,OAAA,GAA0B;;;ADGtH,OAAM,MAAOC,yBAAyB;EAKpCC,YAAoBC,IAAgB,EAAUC,MAAc,EAASC,MAAc;IAA/D,KAAAF,IAAI,GAAJA,IAAI;IAAsB,KAAAC,MAAM,GAANA,MAAM;IAAiB,KAAAC,MAAM,GAANA,MAAM;IAJ3E,KAAAN,aAAa,GAAU,EAAE;IAEzB,KAAAO,UAAU,GAAG,KAAK;EAEqE;EAEvFC,QAAQA,CAAA;IACN,IAAI,CAACC,WAAW,GAAG,IAAIC,WAAW,CAAC,4CAA4C,CAAC;IAChF,IAAI,CAACD,WAAW,CAACE,SAAS,GAAGC,KAAK,IAAG;MACnC,MAAMC,YAAY,GAAGC,IAAI,CAACC,KAAK,CAACH,KAAK,CAACI,IAAI,CAAC;MAC3C,IAAI,CAACV,MAAM,CAACW,GAAG,CAAC,MAAK;QACnB,IAAI,CAACjB,aAAa,CAACkB,IAAI,CAACL,YAAY,CAAC;QACrCM,OAAO,CAACC,GAAG,CAAC,IAAI,CAACpB,aAAa,CAAC;MACjC,CAAC,CAAC;IACJ,CAAC;EACH;EAEAqB,WAAWA,CAAA;IACT,IAAI,IAAI,CAACZ,WAAW,EAAE;MACpB,IAAI,CAACA,WAAW,CAACa,KAAK,EAAE;IAC1B;EACF;EACAC,WAAWA,CAAA;IACT,IAAI,CAAChB,UAAU,GAAG,CAAC,IAAI,CAACA,UAAU;EACpC;EAEAnB,cAAcA,CAACoC,OAAe;IAC5B,IAAI,CAACnB,MAAM,CAACoB,QAAQ,CAAC,CAAC,SAAS,EAAED,OAAO,CAAC,CAAC;EAC5C;EAAC,QAAAE,CAAA,G;qBA7BUxB,yBAAyB,EAAA1B,EAAA,CAAAmD,iBAAA,CAAAC,EAAA,CAAAC,UAAA,GAAArD,EAAA,CAAAmD,iBAAA,CAAAG,EAAA,CAAAC,MAAA,GAAAvD,EAAA,CAAAmD,iBAAA,CAAAnD,EAAA,CAAAwD,MAAA;EAAA;EAAA,QAAAC,EAAA,G;UAAzB/B,yBAAyB;IAAAgC,SAAA;IAAAC,KAAA;IAAAC,IAAA;IAAAC,MAAA;IAAAC,QAAA,WAAAC,mCAAAC,EAAA,EAAAC,GAAA;MAAA,IAAAD,EAAA;QCTtChE,EAAA,CAAAC,cAAA,WAA4F;QAAzFD,EAAA,CAAAE,UAAA,mBAAAgE,sDAAA;UAAA,OAASD,GAAA,CAAAlB,WAAA,EAAa;QAAA,EAAC;QAC1B/C,EAAA,CAAAgB,SAAA,WAAgC;QAAChB,EAAA,CAAAC,cAAA,cAAqB;QAAAD,EAAA,CAAAc,MAAA,GAAwB;QAAAd,EAAA,CAAAe,YAAA,EAAO;QACrFf,EAAA,CAAAoB,UAAA,IAAA+C,wCAAA,iBAWM;QACNnE,EAAA,CAAAe,YAAA,EAAI;;;QAbkDf,EAAA,CAAAiB,SAAA,GAAwB;QAAxBjB,EAAA,CAAAoE,iBAAA,CAAAH,GAAA,CAAAzC,aAAA,CAAA6C,MAAA,CAAwB;QACjBrE,EAAA,CAAAiB,SAAA,EAAgB;QAAhBjB,EAAA,CAAAsB,UAAA,SAAA2C,GAAA,CAAAlC,UAAA,CAAgB"},"metadata":{},"sourceType":"module","externalDependencies":[]}